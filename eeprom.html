<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Documentation</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all_nosearch.js" type="text/javascript"></script>


    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
  </head>

  <body class="eeprom">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
     <a href="http://www.motsai.com">
      <img src="images/logo.png" />
     </a>
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="eeprom-0x0c">EEPROM (0x0C)</h1>

<p>The EEPROM subsystem exists only on the ProMotion board and it uses subsystem ID 0x0C. The EEPROM is currently configured to have 2K bytes of data available for read/write operations. Users can assign ID numbers or other features to each individual board and store the information in the EEPROM. The read/write commands can only be done per page, where each page is 8 bytes. This subsystem has only two commands as follows:</p>
<pre class="highlight c"><code><span class="cp">#define EEPROM_Read     0x01 //reads 8-byte chunks of data
#define EEPROM_Write    0x02 //write 8-bytes of data to the EEPROM
</span></code></pre>

<p>Note that the above commands are placed within the header section of the packet in Byte#3.</p>

<h2 id="data-section">Data Section</h2>

<p>The data section consists of 16 bytes. The first 2 bytes (Byte 4-5) represent the page number. Currently, the configurable EEPROM size is set to 2K bytes, and thus, considering the page sizes of 8 bytes, we can have up to 256 pages. Therefore, the page number value will have the range of 0-255 (Byte 4), and Byte 5 should be set to zero. The next 8 bytes (Byte 6-13), will refer to the read/write data corresponding to a single page. Finally, the last 6 bytes (Byte 14-19) are reserved. Here we explain the two commands in more details:</p>

<h4 id="eeprom_read-command-response-0x01">EEPROM_Read Command/Response (0x01)</h4>

<p>In the command mode, the packet commands Neblina to read 8 bytes from a page number. Here is the packet structure:</p>

<table><thead>
<tr>
<th style="text-align: center">Byte 0 (subsystem)</th>
<th style="text-align: center">Byte 1 (length)</th>
<th style="text-align: center">Byte 2 (CRC)</th>
<th style="text-align: center">Byte 3 (command)</th>
<th style="text-align: center">Byte 4-5</th>
<th style="text-align: center">Byte 6-19</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: center">0x4C</td>
<td style="text-align: center">0x10</td>
<td style="text-align: center">CRC</td>
<td style="text-align: center">0x01 (EEPROM_Read)</td>
<td style="text-align: center">page nb</td>
<td style="text-align: center">Reserved</td>
</tr>
</tbody></table>

<p>In response, Neblina will first send an acknowledge/error packet to confirm the receipt of the command. Next, another response packet with 8 bytes of read data will be sent back to the host:</p>

<table><thead>
<tr>
<th style="text-align: center">Byte 0 (subsystem)</th>
<th style="text-align: center">Byte 1 (length)</th>
<th style="text-align: center">Byte 2 (CRC)</th>
<th style="text-align: center">Byte 3 (command)</th>
<th style="text-align: center">Byte 4-5</th>
<th style="text-align: center">Byte 6-13</th>
<th style="text-align: center">Byte 14-19</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: center">0x0C</td>
<td style="text-align: center">0x10</td>
<td style="text-align: center">CRC</td>
<td style="text-align: center">0x01 (EEPROM_Read)</td>
<td style="text-align: center">page nb</td>
<td style="text-align: center">read data</td>
<td style="text-align: center">Reserved</td>
</tr>
</tbody></table>

<h4 id="eeprom_write-command-response-0x02">EEPROM_Write Command/Response (0x02)</h4>

<p>In the command mode, the packet commands Neblina to write 8 bytes to a page number. Here is the packet structure:</p>

<table><thead>
<tr>
<th style="text-align: center">Byte 0 (subsystem)</th>
<th style="text-align: center">Byte 1 (length)</th>
<th style="text-align: center">Byte 2 (CRC)</th>
<th style="text-align: center">Byte 3 (command)</th>
<th style="text-align: center">Byte 4-5</th>
<th style="text-align: center">Byte 6-13</th>
<th style="text-align: center">Byte 14-19</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: center">0x4C</td>
<td style="text-align: center">0x10</td>
<td style="text-align: center">CRC</td>
<td style="text-align: center">0x02 (EEPROM_Write)</td>
<td style="text-align: center">page nb</td>
<td style="text-align: center">write data</td>
<td style="text-align: center">Reserved</td>
</tr>
</tbody></table>

<p>In response, Neblina will only send an acknowledge/error packet to indicate the validity and receipt of the command issued by the host.</p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
